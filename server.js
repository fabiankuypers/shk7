import express from 'express';
import cors from 'cors';
import Stripe from 'stripe';

const app = express();
const port = 3001;

// Initialize Stripe with your secret key
const stripe = new Stripe('sk_test_51P5HBEK3uE2SBg2eJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJ', {
  apiVersion: '2023-10-16',
});

app.use(cors());
app.use(express.json());

async function createOrGetCustomer(email, name, company) {
  // Check if customer already exists
  const existingCustomers = await stripe.customers.list({
    email: email,
    limit: 1,
  });

  if (existingCustomers.data.length > 0) {
    return existingCustomers.data[0].id;
  }

  // Create new customer
  const customer = await stripe.customers.create({
    email: email,
    name: name,
    metadata: {
      company: company || '',
    },
  });

  return customer.id;
}

app.post('/api/create-payment-intent', async (req, res) => {
  try {
    const { payment_method_id, email, name, company, amount } = req.body;

    console.log('Creating payment intent for:', { email, name, company, amount });

    // Create or get customer
    const customerId = await createOrGetCustomer(email, name, company);

    // For the free trial, we create a Setup Intent to save the payment method
    const setupIntent = await stripe.setupIntents.create({
      payment_method: payment_method_id,
      customer: customerId,
      confirm: true,
      usage: 'off_session',
    });

    console.log('Setup Intent created:', setupIntent.id);

    // Create a subscription with trial period
    const subscription = await stripe.subscriptions.create({
      customer: customerId,
      items: [{ 
        price_data: {
          currency: 'eur',
          product_data: {
            name: 'SHK + Haustechnik Community Mitgliedschaft',
          },
          recurring: {
            interval: 'month',
          },
          unit_amount: 900, // 9 EUR in cents
        }
      }],
      trial_period_days: 90,
      default_payment_method: payment_method_id,
    });

    console.log('Subscription created:', subscription.id);

    res.json({
      success: true,
      setup_intent: setupIntent,
      subscription: subscription,
    });

  } catch (error) {
    console.error('Payment error:', error);
    res.status(400).json({ error: error.message });
  }
});

app.listen(port, () => {
  console.log(`Payment server running on http://localhost:${port}`);
});