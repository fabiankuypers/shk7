import express from 'express';
import cors from 'cors';
import Stripe from 'stripe';

const app = express();
const port = 3001;

// Initialize Stripe with your secret key
// Replace this with your actual Stripe secret key
const stripe = new Stripe('sk_test_51P5HBEK3uE2SBg2eJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJKGJK', {
  apiVersion: '2023-10-16',
});

app.use(cors());
app.use(express.json());

async function createOrGetCustomer(email, name, company) {
  try {
    // Check if customer already exists
    const existingCustomers = await stripe.customers.list({
      email: email,
      limit: 1,
    });

    if (existingCustomers.data.length > 0) {
      return existingCustomers.data[0].id;
    }

    // Create new customer
    const customer = await stripe.customers.create({
      email: email,
      name: name,
      metadata: {
        company: company || '',
      },
    });

    return customer.id;
  } catch (error) {
    console.error('Error creating/getting customer:', error);
    throw error;
  }
}

app.post('/api/create-payment-intent', async (req, res) => {
  try {
    const { payment_method_id, email, name, company, amount } = req.body;

    console.log('Creating payment intent for:', { email, name, company, amount });

    // Validate required fields
    if (!payment_method_id || !email || !name) {
      return res.status(400).json({ 
        error: 'Missing required fields: payment_method_id, email, and name are required' 
      });
    }

    // Create or get customer
    const customerId = await createOrGetCustomer(email, name, company);
    console.log('Customer ID:', customerId);

    // For the free trial, we create a Setup Intent to save the payment method
    const setupIntent = await stripe.setupIntents.create({
      payment_method: payment_method_id,
      customer: customerId,
      confirm: true,
      usage: 'off_session',
    });

    console.log('Setup Intent created:', setupIntent.id, 'Status:', setupIntent.status);

    // Create a subscription with trial period
    const subscription = await stripe.subscriptions.create({
      customer: customerId,
      items: [{ 
        price_data: {
          currency: 'eur',
          product_data: {
            name: 'SHK + Haustechnik Community Mitgliedschaft',
          },
          recurring: {
            interval: 'month',
          },
          unit_amount: 900, // 9 EUR in cents
        }
      }],
      trial_period_days: 90,
      default_payment_method: payment_method_id,
    });

    console.log('Subscription created:', subscription.id, 'Status:', subscription.status);

    res.json({
      success: true,
      setup_intent: setupIntent,
      subscription: subscription,
      customer_id: customerId,
    });

  } catch (error) {
    console.error('Payment error:', error);
    
    // Provide more specific error messages
    let errorMessage = 'Ein unerwarteter Fehler ist aufgetreten.';
    
    if (error.type === 'StripeCardError') {
      errorMessage = 'Ihre Karte wurde abgelehnt. Bitte versuchen Sie es mit einer anderen Karte.';
    } else if (error.type === 'StripeInvalidRequestError') {
      errorMessage = 'Ungültige Anfrage. Bitte überprüfen Sie Ihre Eingaben.';
    } else if (error.type === 'StripeAPIError') {
      errorMessage = 'Verbindungsfehler zu unserem Zahlungsanbieter. Bitte versuchen Sie es später erneut.';
    } else if (error.type === 'StripeConnectionError') {
      errorMessage = 'Netzwerkfehler. Bitte überprüfen Sie Ihre Internetverbindung.';
    } else if (error.type === 'StripeAuthenticationError') {
      errorMessage = 'Authentifizierungsfehler. Bitte kontaktieren Sie den Support.';
    }

    res.status(400).json({ 
      error: errorMessage,
      details: error.message 
    });
  }
});

app.listen(port, () => {
  console.log(`Payment server running on http://localhost:${port}`);
  console.log('Stripe API version: 2023-10-16');
});